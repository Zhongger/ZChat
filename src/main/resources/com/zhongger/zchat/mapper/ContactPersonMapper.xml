<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhongger.zchat.mapper.ContactPersonMapper">
    <insert id="insert" parameterType="com.zhongger.zchat.mapper.ContactPersonMapper" useGeneratedKeys="true" keyProperty="id">
        insert  into contactperson (person_name,person_phone,user_id,create_date,person_id) values (#{person_name},#{person_phone},#{user_id},#{create_date},#{person_id})
</insert>
    <delete id="deleteforuserid" parameterType="string">
        delete  from contactperson where user_id=(select user_id from user where user_name=#{username} or phone=#{username})
    </delete>
    <delete id="delete" parameterType="com.zhongger.zchat.DTO.ContactPersonDelete">
        delete from contactperson where user_id=(select user_id from user where user_name=#{user_username} or phone=#{user_username}) and person_phone =#{phone}
    </delete>
    <resultMap id="select" type="com.zhongger.zchat.entity.Contactperson">
        <result column="person_name" property="person_name"></result>
        <result column="person_phone" property="person_phone"></result>
        <result column="user_id" property="user_id"></result>
        <result column="create_date" property="create_date"></result>
        <result column="id" property="id"></result>
        <result column="person_id" property="person_id"></result>

    </resultMap>
    <select id="select" resultMap="select" parameterType="com.zhongger.zchat.DTO.ContactPersonDelete">
        select * from contactperson where user_id=(select user_id from user where user_name=#{user_username} or phone=#{user_username})  and person_phone =#{phone}
    </select>
    <resultMap id="selectfor" type="com.zhongger.zchat.DTO.ContactPersonInfo">
        <result column="user_id" property="userId"></result>
        <result column="user_name" property="userName"></result>
        <result column="phone" property="phone"></result>
        <result column="image_name" property="imag"></result>
        <result column="staus" property="staus"></result>
    </resultMap>
    <select id="selectforuserid" resultMap="selectfor">
        SELECT b.user_id,b.user_name,b.phone,c.image_name,b.staus FROM `contactperson` a,`user` b,`userAvatar` c WHERE a.person_id=b.user_id and a.person_id=c.user_id and a.user_id=#{user_id}
    </select>
</mapper>
